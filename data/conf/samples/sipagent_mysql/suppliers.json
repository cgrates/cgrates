{
	"sip_agent": {
		"request_processors": [
			{
				"id": "NAPTRRoutesQuery",
				"filters": ["*string:~*vars.Method:INVITE"],
				"flags": ["*event", "*routes","*continue"],
				"request_fields":[
					{"tag": "Account", "path": "*cgreq.Account", "type": "*variable",
						"value": "~*req.From{*sipuri_user}", "mandatory": true},
					{"tag": "Destination", "path": "*cgreq.Destination", "type": "*variable",
						"value": "~*req.To{*sipuri_user}", "mandatory": true}
				],
				"reply_fields":[
				],
			},
			{
				"id": "NAPTRSuppliersOneSupplier",
				"filters": ["*string:~*vars.Method:INVITE",
					"*gte:~*cgrep.Routes.Count:1"],
				"flags": ["*none","*continue"], // do not send request to CGRateS
				"reply_fields":[
					{"tag": "Request", "path": "*rep.Request", "type": "*constant",
						"value": "SIP/2.0 302 Moved Temporarily"},
					{"tag": "Contact", "path": "*rep.Contact", "type": "*composed",
							"value":"\""},
					{"tag": "Contact", "path": "*rep.Contact", "type": "*composed",
							"value":"~*cgreq.Destination"},
					{"tag": "Contact", "path": "*rep.Contact", "type": "*composed",
							"value":"\" <sip:"},
					{"tag": "Contact", "path": "*rep.Contact", "type": "*composed",
							"value":"~*cgreq.Destination"},
					{"tag": "Contact", "path": "*rep.Contact", "type": "*composed",
							"value":"@"},
					{"tag": "Contact", "path": "*rep.Contact", "type": "*composed",
						"value": "~*cgrep.Routes.SortedRoutes[0].RouteParameters"},
					{"tag": "Contact", "path": "*rep.Contact", "type": "*composed",
							"value":">;q=0.7; expires=3600"},
				],
			},
			{
				"id": "NAPTRSuppliersTwoSuppliers",
				"filters": ["*string:~*vars.Method:INVITE",
					"*gte:~*cgrep.Routes.Count:2"],
				"flags": ["*none","*continue"],
				"reply_fields":[
					{"tag": "Request", "path": "*rep.Request", "type": "*constant",
						"value": "SIP/2.0 302 Moved Temporarily"},
					{"tag": "Contact", "path": "*rep.Contact", "type": "*composed",
							"value":"\""},
					{"tag": "Contact", "path": "*rep.Contact", "type": "*composed",
							"value":"~*cgreq.Destination"},
					{"tag": "Contact", "path": "*rep.Contact", "type": "*composed",
							"value":"\" <sip:"},
					{"tag": "Contact", "path": "*rep.Contact", "type": "*composed",
							"value":"~*cgreq.Destination"},
					{"tag": "Contact", "path": "*rep.Contact", "type": "*composed",
							"value":"@"},
					{"tag": "Contact", "path": "*rep.Contact", "type": "*composed",
						"value": "~*cgrep.Routes.SortedRoutes[1].RouteParameters"},
					{"tag": "Contact", "path": "*rep.Contact", "type": "*composed",
							"value":">;q=0.1"},
				],
			},
		],
	},

}
